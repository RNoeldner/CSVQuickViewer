<Project Sdk="Microsoft.NET.Sdk">

  <PropertyGroup>
    <TargetFramework>net8.0</TargetFramework>
    <ImplicitUsings>enable</ImplicitUsings>
    <Nullable>enable</Nullable>
  </PropertyGroup>

  <Target Name="PostBuild" AfterTargets="PostBuildEvent">
    <Exec Command="@echo off&#xD;&#xA;REM ===============================&#xD;&#xA;REM Post-Build Script für CSVQuickViewer&#xD;&#xA;REM ===============================&#xD;&#xA;&#xD;&#xA;REM 1. PDB-Dateien aus Release-Ordner löschen&#xD;&#xA;DEL /Q &quot;$(SolutionDir)Application\bin\Release\net472\*.pdb&quot;&#xD;&#xA;&#xD;&#xA;REM 2. Inno Setup Installer erstellen&#xD;&#xA;REM Prüfen, ob ISCC.exe über Umgebungsvariable INNO_SETUP_PATH gefunden werden kann&#xD;&#xA;IF DEFINED INNO_SETUP_PATH (&#xD;&#xA;    SET ISCC=&quot;%25INNO_SETUP_PATH%25\ISCC.exe&quot;&#xD;&#xA;) ELSE (&#xD;&#xA;    REM Fallback: prüfen, ob Inno Setup über Standard-Installationspfad gefunden wird&#xD;&#xA;    IF EXIST &quot;C:\Program Files (x86)\Inno Setup 6\ISCC.exe&quot; (&#xD;&#xA;        SET ISCC=&quot;C:\Program Files (x86)\Inno Setup 6\ISCC.exe&quot;&#xD;&#xA;    ) ELSE (&#xD;&#xA;        ECHO Fehler: Inno Setup ISCC.exe nicht gefunden!&#xD;&#xA;        EXIT /B 1&#xD;&#xA;    )&#xD;&#xA;)&#xD;&#xA;&#xD;&#xA;REM Projekt-Datei für Inno Setup&#xD;&#xA;%25ISCC%25 &quot;$(ProjectDir)InnoSetup.net472.iss&quot;&#xD;&#xA;&#xD;&#xA;REM 3. ZIP-Archiv mit PowerShell erstellen&#xD;&#xA;powershell -Command &quot;Compress-Archive -Path '$(SolutionDir)Application\bin\Release\net472\*' -DestinationPath '$(ProjectDir)..\CSVQuickViewerPortable.Net472.zip' -Force&quot;&#xD;&#xA;&#xD;&#xA;REM 4. Installer-EXE kopieren&#xD;&#xA;COPY /Y &quot;$(ProjectDir)bin\CsvQuickViewerInstaller.exe&quot; &quot;$(ProjectDir)..\CSVQuickViewerInstaller.Net472.exe&quot;&#xD;&#xA;&#xD;&#xA;ECHO Post-Build abgeschlossen!&#xD;&#xA;" />
  </Target>

  <ItemGroup>
    <None Remove="InnoSetup.net472.iss" />
  </ItemGroup>

  <ItemGroup>
    <Content Include="InnoSetup.net472.iss" />
  </ItemGroup>

  <Target Name="PreBuild" BeforeTargets="PreBuildEvent">
    <Exec Command="IF EXIST &quot;$(ProjectDir)..\CSVQuickViewerInstaller.Net472.exe&quot;  (&#xA;DEL &quot;$(ProjectDir)..\CSVQuickViewerInstaller.Net472.exe&quot; &#xA;)&#xD;&#xA;IF EXIST &quot;$(ProjectDir)..\CSVQuickViewerPortable.Net472.zip&quot;  (&#xA;DEL &quot;$(ProjectDir)..\CSVQuickViewerPortable.Net472.zip&quot; &#xA;)&#xD;&#xA;" />
  </Target>

</Project>
